webpackJsonp([5],{"+QBx":function(t,s,a){s=t.exports=a("l95E")(!1),s.push([t.i,"\n.el-input-group[data-v-75ca4269]{\r\n  width: 20%;\n}\n.cms-body .cms-form .flex-100[data-v-75ca4269],.cms-body .cms-form .flex-50[data-v-75ca4269]{\r\n  border-top: 1px dashed #eee;\n}\n.cms-body .cms-form .flex-no-border[data-v-75ca4269]{\r\n border-top: 0px dashed #eee;\n}\n.cms-body .cms-col1[data-v-75ca4269]{\r\n  width: 10%\n}\n.cms-body .cms-col2[data-v-75ca4269]{\r\n  width: 20%\n}\n.cms-body .cms-col3[data-v-75ca4269]{\r\n  width: 30%\n}\n.cms-body .cms-col4[data-v-75ca4269]{\r\n  width: 40%\n}\n.cms-body .cms-col5[data-v-75ca4269]{\r\n  width: 50%\n}\n.cms-body .cms-col6[data-v-75ca4269]{\r\n  width: 60%\n}\n.cms-body .cms-col7[data-v-75ca4269]{\r\n  width: 70%\n}\n.cms-body .cms-col8[data-v-75ca4269]{\r\n  width: 80%\n}\n.cms-body .cms-col9[data-v-75ca4269]{\r\n  width: 90%\n}\n.cms-body .cms-col10[data-v-75ca4269]{\r\n  width: 100%\n}\n.ftp-div[data-v-75ca4269]{\r\n  padding: 15px 0 15px 162px;\r\n  -webkit-box-sizing: border-box;\r\n          box-sizing: border-box;\r\n  font-size: 14px;\n}\n.ftp-item[data-v-75ca4269]{\r\n  background-color: #fbfdff;\r\n  border: 1px #eee dotted;\r\n  padding: 15px 15px ;\n}\n.ftp-item[data-v-75ca4269]{\r\n  line-height:50px;\n}\n.ftp-item > div >div[data-v-75ca4269]{\r\n  display: inline-block;\n}\n.gray[data-v-75ca4269]{\r\n  font-size: 14px;\n}\r\n",""])},ehIu:function(t,s,a){var e=a("+QBx");"string"==typeof e&&(e=[[t.i,e,""]]),e.locals&&(t.exports=e.locals);a("8bSs")("4b7b2bfa",e,!0)},tv2R:function(t,s,a){"use strict";function e(t){a("ehIu")}Object.defineProperty(s,"__esModule",{value:!0});var n=a("HzJ8"),o=a.n(n),i=a("2sCs"),l=a.n(i),c=a("x1ym"),r=a("lcoF"),d={mixins:[r.a],data:function(){var t=c.a.required("此项必填");return{dataInfo:{},setps:[],roles:[],defaultRole:{},ftp_div_show:!1,rules:{name:[t],priority:[t,c.a.number("必须为数字")],cross:[t]}}},methods:{getParam:function(){var t=[],s=[];if(this.setps.length>0){var a=!0,e=!1,n=void 0;try{for(var i,l=o()(this.setps);!(a=(i=l.next()).done);a=!0){var c=i.value;t.push(c.roleId),s.push(c.countersign)}}catch(t){e=!0,n=t}finally{try{!a&&l.return&&l.return()}finally{if(e)throw n}}this.dataInfo.roleIds=t.join(","),this.dataInfo.countersigns=s.join(",")}delete this.dataInfo.events,delete this.dataInfo.nodes},getDataInfo:function(t){var s=this;this.$api;l.a.post(this.$api.workflowGet,{id:t}).then(function(t){s.loading=!1,s.dataInfo=t.body,l.a.post(s.$api.roleList).then(function(t){"200"==t.code&&(s.roles=t.body,t.body.length>0&&(s.defaultRole=t.body[0]))}),t.body.nodes.length>0&&(s.setps=t.body.nodes,s.ftp_div_show=s.setps.length>0)}).catch(function(t){s.loading=!1})},update:function(t){this.getParam(),this.updateDataInfo(this.$api.workflowUpdate,this.dataInfo,"list")},add:function(t){this.getParam(),this.saveDataInfo(t,this.$api.workflowSave,this.dataInfo,"list")},setpDelete:function(t){this.setps.splice(t,1),this.ftp_div_show=this.setps.length>0},setpAdd:function(){this.setps.push({countersign:!1,roleId:this.defaultRole.id,roleName:this.defaultRole.name}),this.ftp_div_show=this.setps.length>0}},created:function(){this.getDataInfo(this.id)}},p=function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("section",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"cms-body"},[a("cms-back"),t._v(" "),a("el-form",{ref:"form",staticClass:"cms-form",attrs:{model:t.dataInfo,rules:t.rules,"label-width":"162px"}},[a("el-form-item",{staticClass:"flex-100 ",attrs:{label:"名称",prop:"name"}},[a("el-input",{staticClass:"cms-width",model:{value:t.dataInfo.name,callback:function(s){t.$set(t.dataInfo,"name",s)},expression:"dataInfo.name"}})],1),t._v(" "),a("el-form-item",{staticClass:"flex-100",attrs:{label:"描述"}},[a("el-input",{staticClass:"cms-width",attrs:{type:"textarea"},model:{value:t.dataInfo.description,callback:function(s){t.$set(t.dataInfo,"description",s)},expression:"dataInfo.description"}})],1),t._v(" "),a("el-form-item",{staticClass:"flex-50 ",attrs:{label:"排序",prop:"priority"}},[a("el-input",{staticClass:"cms-width",attrs:{type:"number"},model:{value:t.dataInfo.priority,callback:function(s){t.$set(t.dataInfo,"priority",s)},expression:"dataInfo.priority"}})],1),t._v(" "),a("el-form-item",{staticClass:"flex-50 "}),t._v(" "),a("el-form-item",{staticClass:"flex-100 ",attrs:{label:"是否可以跨级审核",prop:"cross"}},[a("el-radio-group",{staticClass:"cms-width",model:{value:t.dataInfo.cross,callback:function(s){t.$set(t.dataInfo,"cross",s)},expression:"dataInfo.cross"}},[a("el-radio",{attrs:{label:!0}},[t._v("是")]),t._v(" "),a("el-radio",{attrs:{label:!1}},[t._v("否")])],1)],1),t._v(" "),a("el-form-item",{staticClass:"flex-100 ",attrs:{label:"工作流步骤"}},[a("el-button",{on:{click:t.setpAdd}},[t._v("增加")])],1),t._v(" "),a("section",{directives:[{name:"show",rawName:"v-show",value:t.ftp_div_show,expression:"ftp_div_show"}],staticClass:"flex-100 ftp-div flex-no-border "},[a("section",{staticClass:"ftp-item cms-col10"},[a("div",{staticClass:"cms-col10 "},[a("div",{staticClass:" cms-col1 "},[t._v("\n                步骤\n              ")]),t._v(" "),a("div",{staticClass:"cms-col3"},[t._v("\n                角色\n              ")]),t._v(" "),a("div",{staticClass:"cms-col3"},[t._v("\n                类型\n              ")]),t._v(" "),a("div",{staticClass:"cms-col1"},[t._v("\n                操作\n              ")])]),t._v(" "),t._l(t.setps,function(s,e){return a("div",{key:e,staticClass:"cms-col10 "},[a("div",{staticClass:" cms-col1 "},[t._v("\n                第\n                "+t._s(e+1)+"\n                步\n              ")]),t._v(" "),a("div",{staticClass:"cms-col3"},[a("el-select",{staticClass:"cms-col7",model:{value:t.setps[e].roleId,callback:function(s){t.$set(t.setps[e],"roleId",s)},expression:"setps[index].roleId"}},t._l(t.roles,function(t,s){return a("el-option",{key:s,attrs:{label:t.name,value:t.id}})}))],1),t._v(" "),a("div",{staticClass:"cms-col3"},[a("el-radio-group",{staticClass:"cms-col10",model:{value:t.setps[e].countersign,callback:function(s){t.$set(t.setps[e],"countersign",s)},expression:"setps[index].countersign"}},[a("el-radio",{attrs:{label:!0}},[t._v("会签")]),t._v(" "),a("el-radio",{attrs:{label:!1}},[t._v("普通流转")])],1)],1),t._v(" "),a("div",{staticClass:"cms-col1"},[a("cms-button",{attrs:{type:"delete"},nativeOn:{click:function(s){t.setpDelete(e)}}})],1)])}),t._v(" "),a("div",{staticClass:"cms-col10 gray"},[t._v("\n              说明：会签表示需要所选角色中所有用户都审核才能进入下一步，普通流转则只需要其中任意一个用户审核就能进入下一步。\n            ")])],2)]),t._v(" "),a("div",{staticClass:"form-footer"},[t.isType("save")?a("el-button",{directives:[{name:"perms",rawName:"v-perms",value:"/workflow/save",expression:"'/workflow/save'"}],attrs:{type:"warning"},on:{click:function(s){t.add(!0)}}},[t._v("\n              提交并继续添加\n            ")]):t._e(),t._v(" "),t.isType("save")?a("el-button",{directives:[{name:"perms",rawName:"v-perms",value:"/workflow/save",expression:"'/workflow/save'"}],attrs:{type:"primary"},on:{click:function(s){t.add(!1)}}},[t._v("\n              提交\n            ")]):t._e(),t._v(" "),t.isType("update")?a("el-button",{directives:[{name:"perms",rawName:"v-perms",value:"/workflow/update",expression:"'/workflow/update'"}],attrs:{type:"primary"},on:{click:function(s){t.update()}}},[t._v("\n              修改\n            ")]):t._e(),t._v(" "),a("el-button",{attrs:{type:"info"},on:{click:t.$reset}},[t._v("重置")]),t._v(" "),t.isType("save")?a("span",{staticClass:"gray"},[t._v("选择“提交并继续添加”按钮会停留在添加页面；选择“提交”按钮后将跳转到对应的列表页")]):t._e()],1)],1)],1)},v=[],f={render:p,staticRenderFns:v},m=f,u=a("8AGX"),h=e,b=u(d,m,!1,h,"data-v-75ca4269",null);s.default=b.exports}});